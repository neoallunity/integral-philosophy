\doxysection{Prelude.\+hs}
\hypertarget{_prelude_8hs_source}{}\label{_prelude_8hs_source}\index{/home/domini/src/Magazine/Magazine/haskell-\/project/src/IntegralPhilosophy/Prelude.hs@{/home/domini/src/Magazine/Magazine/haskell-\/project/src/IntegralPhilosophy/Prelude.hs}}
\mbox{\hyperlink{_prelude_8hs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00001}00001\ \{-\/\#\ LANGUAGE\ OverloadedStrings\ \#-\/\}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00003}00003\ module\ IntegralPhilosophy.Prelude\ where}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00005}00005\ import\ qualified\ Control.Exception\ as\ Exception}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00006}00006\ import\ qualified\ Data.Text\ as\ Text}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00007}00007\ import\ qualified\ Data.Text.IO\ as\ TextIO}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00008}00008\ import\ qualified\ Data.Char\ as\ Char}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00009}00009\ import\ qualified\ System.IO\ as\ IO}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00010}00010\ import\ qualified\ Data.Time\ as\ Time}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00011}00011\ import\ Data.Time\ (diffUTCTime)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00013}00013\ -\/-\/\ |\ Enhanced\ error\ handling\ for\ academic\ publishing}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00014}00014\ safeReadFile\ ::\ FilePath\ -\/>\ IO\ (Either\ String\ Text.Text)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00015}00015\ safeReadFile\ path\ =\ Exception.catch}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00016}00016\ \ \ (Right\ <\$>\ TextIO.readFile\ path)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00017}00017\ \ \ (\(\backslash\)e\ -\/>\ pure\ \$\ Left\ \$\ "{}Failed\ to\ read\ "{}\ ++\ path\ ++\ "{}:\ "{}\ ++\ show\ (e\ ::\ Exception.SomeException))}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00019}00019\ -\/-\/\ |\ Safe\ file\ writing\ with\ backup}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00020}00020\ safeWriteFile\ ::\ FilePath\ -\/>\ Text.Text\ -\/>\ IO\ (Either\ String\ ())}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00021}00021\ safeWriteFile\ path\ content\ =\ Exception.catch}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00022}00022\ \ \ (do}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00023}00023\ \ \ \ \ let\ backupPath\ =\ path\ ++\ "{}.backup"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00024}00024\ \ \ \ \ IO.withFile\ backupPath\ IO.WriteMode\ \$\ \(\backslash\)handle\ -\/>\ TextIO.hPutStr\ handle\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00025}00025\ \ \ \ \ TextIO.writeFile\ path\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00026}00026\ \ \ \ \ pure\ \$\ Right\ ()}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00027}00027\ \ \ )\ (\(\backslash\)e\ -\/>\ pure\ \$\ Left\ \$\ "{}Failed\ to\ write\ "{}\ ++\ path\ ++\ "{}:\ "{}\ ++\ show\ (e\ ::\ Exception.SomeException))}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00029}00029\ -\/-\/\ |\ Academic\ publication\ validation\ utilities}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00030}00030\ validateISBN\ ::\ Text.Text\ -\/>\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00031}00031\ validateISBN\ isbn\ =\ Text.length\ isbn\ ==\ 13\ \&\&\ Text.all\ Char.isDigit\ isbn}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00033}00033\ -\/-\/\ |\ Enhanced\ timing\ utilities\ for\ publication\ processing}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00034}00034\ measureTime\ ::\ IO\ a\ -\/>\ IO\ (a,\ Double)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00035}00035\ measureTime\ action\ =\ do}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00036}00036\ \ \ startTime\ <-\/\ Time.getCurrentTime}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00037}00037\ \ \ result\ <-\/\ action}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00038}00038\ \ \ endTime\ <-\/\ Time.getCurrentTime}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00039}00039\ \ \ pure\ (result,\ realToFrac\ \$\ Time.diffUTCTime\ endTime\ startTime)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00041}00041\ -\/-\/\ |\ Common\ validation\ patterns\ for\ academic\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00042}00042\ containsMathContent\ ::\ Text.Text\ -\/>\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00043}00043\ containsMathContent\ content\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00044}00044\ \ \ "{}\$"{}\ \`{}Text.isInfixOf`\ content\ ||\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00045}00045\ \ \ "{}\(\backslash\)\(\backslash\)begin\{"{}\ \`{}Text.isInfixOf`\ content\ ||}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00046}00046\ \ \ "{}\(\backslash\)\(\backslash\)("{}\ \`{}Text.isInfixOf`\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00048}00048\ -\/-\/\ |\ Metadata\ extraction\ utilities}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00049}00049\ extractTitle\ ::\ Text.Text\ -\/>\ Maybe\ Text.Text}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00050}00050\ extractTitle\ content\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00051}00051\ \ \ case\ Text.lines\ content\ of}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00052}00052\ \ \ \ \ []\ -\/>\ Nothing}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00053}00053\ \ \ \ \ (firstLine:\_)\ -\/>\ Just\ \$\ Text.strip\ firstLine}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00055}00055\ -\/-\/\ |\ LaTeX\ structure\ detection}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00056}00056\ detectLatexStructure\ ::\ Text.Text\ -\/>\ LatexStructure}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00057}00057\ detectLatexStructure\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00058}00058\ \ \ |\ "{}\(\backslash\)\(\backslash\)documentclass"{}\ \`{}Text.isInfixOf`\ content\ =\ FullDocument}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00059}00059\ \ \ |\ "{}\(\backslash\)\(\backslash\)begin\{"{}\ \`{}Text.isInfixOf`\ content\ =\ Fragment}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00060}00060\ \ \ |\ otherwise\ =\ PlainText}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00062}00062\ -\/-\/\ |\ Data\ type\ for\ LaTeX\ structure\ classification}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00063}00063\ data\ LatexStructure\ =\ FullDocument\ |\ Fragment\ |\ PlainText}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00064}00064\ \ \ deriving\ (Show,\ Eq,\ Ord)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00066}00066\ -\/-\/\ |\ Core\ validation\ result\ type}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00067}00067\ data\ ValidationResult\ =\ ValidationResult}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00068}00068\ \ \ \{\ valid\ ::\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00069}00069\ \ \ ,\ errors\ ::\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00070}00070\ \ \ ,\ warnings\ ::\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00071}00071\ \ \ ,\ metadata\ ::\ [(Text.Text,\ Text.Text)]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00072}00072\ \ \ \}\ deriving\ (Show,\ Eq)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00074}00074\ -\/-\/\ |\ Monoid\ instance\ for\ combining\ validation\ results}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00075}00075\ instance\ Semigroup\ ValidationResult\ where}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00076}00076\ \ \ (ValidationResult\ v1\ e1\ w1\ m1)\ <>\ (ValidationResult\ v2\ e2\ w2\ m2)\ =}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00077}00077\ \ \ \ \ ValidationResult\ (v1\ \&\&\ v2)\ (e1\ ++\ e2)\ (w1\ ++\ w2)\ (m1\ ++\ m2)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00079}00079\ instance\ Monoid\ ValidationResult\ where}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00080}00080\ \ \ mempty\ =\ ValidationResult\ True\ []\ []\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00082}00082\ -\/-\/\ |\ Success\ constructor\ for\ validation}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00083}00083\ validationSuccess\ ::\ ValidationResult}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00084}00084\ validationSuccess\ =\ ValidationResult\ True\ []\ []\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00086}00086\ -\/-\/\ |\ Error\ constructor\ for\ validation}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00087}00087\ validationError\ ::\ [Text.Text]\ -\/>\ ValidationResult}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00088}00088\ validationError\ errs\ =\ ValidationResult\ False\ errs\ []\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00090}00090\ -\/-\/\ |\ Warning\ constructor\ for\ validation}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00091}00091\ validationWarning\ ::\ [Text.Text]\ -\/>\ ValidationResult}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00092}00092\ validationWarning\ warns\ =\ ValidationResult\ True\ []\ warns\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00094}00094\ -\/-\/\ |\ Enhanced\ result\ type\ for\ complex\ operations}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00095}00095\ data\ Result\ a\ =\ Success\ a\ |\ Failure\ Text.Text\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00096}00096\ \ \ deriving\ (Show,\ Eq,\ Functor)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00098}00098\ -\/-\/\ |\ Utility\ functions\ for\ Result\ type}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00099}00099\ isSuccess\ ::\ Result\ a\ -\/>\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00100}00100\ isSuccess\ (Success\ \_)\ =\ True}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00101}00101\ isSuccess\ (Failure\ \_\ \_)\ =\ False}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00103}00103\ getSuccess\ ::\ Result\ a\ -\/>\ Maybe\ a}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00104}00104\ getSuccess\ (Success\ val)\ =\ Just\ val}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00105}00105\ getSuccess\ (Failure\ \_\ \_)\ =\ Nothing}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00107}00107\ getErrors\ ::\ Result\ a\ -\/>\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00108}00108\ getErrors\ (Success\ \_)\ =\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00109}00109\ getErrors\ (Failure\ err\ \_)\ =\ [err]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00111}00111\ getWarnings\ ::\ Result\ a\ -\/>\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00112}00112\ getWarnings\ (Success\ \_)\ =\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00113}00113\ getWarnings\ (Failure\ \_\ warns)\ =\ warns}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00115}00115\ -\/-\/\ |\ Academic\ publishing\ constants}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00116}00116\ standardPaperSize\ ::\ (Int,\ Int)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00117}00117\ standardPaperSize\ =\ (210,\ 297)\ -\/-\/\ A4\ in\ mm}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00119}00119\ standardFontSize\ ::\ Int}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00120}00120\ standardFontSize\ =\ 12}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00122}00122\ maxAbstractLength\ ::\ Int}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00123}00123\ maxAbstractLength\ =\ 300}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00125}00125\ -\/-\/\ |\ Common\ LaTeX\ environments\ for\ academic\ papers}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00126}00126\ academicEnvironments\ ::\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00127}00127\ academicEnvironments\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00128}00128\ \ \ [\ "{}abstract"{},\ "{}keywords"{},\ "{}acknowledgments"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00129}00129\ \ \ ,\ "{}theorem"{},\ "{}lemma"{},\ "{}proposition"{},\ "{}corollary"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00130}00130\ \ \ ,\ "{}proof"{},\ "{}definition"{},\ "{}example"{},\ "{}remark"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00131}00131\ \ \ ,\ "{}figure"{},\ "{}table"{},\ "{}algorithm"{},\ "{}equation"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00132}00132\ \ \ ]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00134}00134\ -\/-\/\ |\ Essential\ LaTeX\ packages\ for\ academic\ publishing}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00135}00135\ essentialPackages\ ::\ [Text.Text]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00136}00136\ essentialPackages\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00137}00137\ \ \ [\ "{}inputenc"{},\ "{}fontenc"{},\ "{}graphicx"{},\ "{}amsmath"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00138}00138\ \ \ ,\ "{}amssymb"{},\ "{}amsfonts"{},\ "{}hyperref"{},\ "{}geometry"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00139}00139\ \ \ ,\ "{}babel"{},\ "{}times"{},\ "{}natbib"{},\ "{}url"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00140}00140\ \ \ ]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00142}00142\ -\/-\/\ |\ Validation\ helpers}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00143}00143\ hasRequiredPackages\ ::\ [Text.Text]\ -\/>\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00144}00144\ hasRequiredPackages\ used\ =\ all\ (`elem`\ used)\ essentialPackages}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00146}00146\ hasValidStructure\ ::\ LatexStructure\ -\/>\ Bool}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00147}00147\ hasValidStructure\ FullDocument\ =\ True}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00148}00148\ hasValidStructure\ Fragment\ =\ True}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00149}00149\ hasValidStructure\ PlainText\ =\ True}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00151}00151\ -\/-\/\ |\ Performance\ monitoring\ utilities}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00152}00152\ timeExecution\ ::\ String\ -\/>\ IO\ a\ -\/>\ IO\ a}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00153}00153\ timeExecution\ description\ action\ =\ do}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00154}00154\ \ \ (result,\ duration)\ <-\/\ measureTime\ action}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00155}00155\ \ \ putStrLn\ \$\ description\ ++\ "{}\ took\ "{}\ ++\ show\ duration\ ++\ "{}\ seconds"{}}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00156}00156\ \ \ return\ result}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00158}00158\ -\/-\/\ |\ File\ processing\ utilities\ with\ error\ handling}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00159}00159\ processFile\ ::\ (Text.Text\ -\/>\ Result\ a)\ -\/>\ FilePath\ -\/>\ IO\ (Result\ a)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00160}00160\ processFile\ processor\ path\ =\ do}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00161}00161\ \ \ result\ <-\/\ safeReadFile\ path}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00162}00162\ \ \ case\ result\ of}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00163}00163\ \ \ \ \ Left\ err\ -\/>\ pure\ \$\ Failure\ (Text.pack\ err)\ []}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00164}00164\ \ \ \ \ Right\ content\ -\/>\ pure\ \$\ processor\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00166}00166\ -\/-\/\ |\ Batch\ processing\ utilities}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00167}00167\ processFiles\ ::\ (Text.Text\ -\/>\ Result\ a)\ -\/>\ [FilePath]\ -\/>\ IO\ [Result\ a]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00168}00168\ processFiles\ processor\ paths\ =\ mapM\ (processFile\ processor)\ paths}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00170}00170\ -\/-\/\ |\ Academic\ metadata\ extraction}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00171}00171\ extractMetadata\ ::\ Text.Text\ -\/>\ [(Text.Text,\ Text.Text)]}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00172}00172\ extractMetadata\ content\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00173}00173\ \ \ let\ lines'\ =\ Text.lines\ content}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00174}00174\ \ \ \ \ \ \ metadataLines\ =\ filter\ (\(\backslash\)line\ -\/>\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00175}00175\ \ \ \ \ \ \ \ \ "{}\(\backslash\)\(\backslash\)title"{}\ \`{}Text.isPrefixOf`\ line\ ||}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00176}00176\ \ \ \ \ \ \ \ \ "{}\(\backslash\)\(\backslash\)author"{}\ \`{}Text.isPrefixOf`\ line\ ||}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00177}00177\ \ \ \ \ \ \ \ \ "{}\(\backslash\)\(\backslash\)date"{}\ \`{}Text.isPrefixOf`\ line)\ lines'}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00178}00178\ \ \ \ in\ map\ parseMetadataLine\ metadataLines}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00179}00179\ \ \ where}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00180}00180\ \ \ \ \ parseMetadataLine\ line\ =\ }
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00181}00181\ \ \ \ \ \ \ let\ (key,\ value)\ =\ Text.breakOn\ "{}\{"{}\ line}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ cleanValue\ =\ Text.drop\ 1\ \$\ Text.init\ value}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00183}00183\ \ \ \ \ \ \ \ in\ (Text.tail\ key,\ cleanValue)}
\DoxyCodeLine{\Hypertarget{_prelude_8hs_source_l00184}00184\ }

\end{DoxyCode}
